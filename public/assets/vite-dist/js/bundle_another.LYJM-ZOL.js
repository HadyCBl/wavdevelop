import{m as e,a as t}from"./chunk_alpine.D-O2uL2K.js";import{$ as n}from"./chunk_jquery.Cg98Jr1F.js";import{l as o}from"./chunk_datatables.CVkwJyTm.js";import{a,s as r,b as i,T as s,M as c}from"./chunk_vendors.BgDCcFUb.js";class l{constructor(e={}){this.config={clientKey:e.clientKey||null,channelPrefix:e.channelPrefix||"app",channelHuella:e.channelHuella||"huella",userId:e.userId||null,agencyId:e.agencyId||null,enabled:!1!==e.enabled,echoMessages:e.echoMessages||!1,debug:e.debug||!1},this.realtime=null,this.channels=new Map,this.handlers=new Map,this.connectionState="disconnected",this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.config.enabled&&this.config.clientKey?this.init():this.log("warn","Ably no est√° configurado o est√° deshabilitado")}init(){try{this.realtime=new a.Realtime({key:this.config.clientKey,echoMessages:this.config.echoMessages,autoConnect:!0,disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4}),this.setupConnectionHandlers(),this.log("info","‚úÖ Ably inicializado correctamente")}catch(e){this.log("error","‚ùå Error inicializando Ably:",e),this.config.enabled=!1}}setupConnectionHandlers(){this.realtime.connection.on("connected",(()=>{this.connectionState="connected",this.reconnectAttempts=0,this.log("info","‚úÖ Conectado a Ably"),this.emit("connected")})),this.realtime.connection.on("connecting",(()=>{this.connectionState="connecting",this.log("info","üîÑ Conectando a Ably...")})),this.realtime.connection.on("disconnected",(()=>{this.connectionState="disconnected",this.log("warn","‚ö†Ô∏è Desconectado de Ably"),this.emit("disconnected")})),this.realtime.connection.on("suspended",(()=>{this.connectionState="suspended",this.log("warn","‚ö†Ô∏è Conexi√≥n suspendida"),this.emit("suspended")})),this.realtime.connection.on("failed",(()=>{this.connectionState="failed",this.log("error","‚ùå Error de conexi√≥n"),this.emit("failed"),this.handleReconnect()}))}handleReconnect(){if(this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const e=Math.min(1e3*Math.pow(2,this.reconnectAttempts),3e4);this.log("info",`üîÑ Reintentando conexi√≥n en ${e/1e3}s (intento ${this.reconnectAttempts})`),setTimeout((()=>{this.realtime.connection.connect()}),e)}else this.log("error","‚ùå M√°ximo de reintentos alcanzado"),this.emit("max-reconnect-reached")}subscribeToUser(e,t,n){if(!this.config.userId)return this.log("warn","No se puede suscribir: userId no configurado"),null;const o=`${this.config.channelPrefix}:user:${this.config.userId}`,a=this.getChannel(o);return e&&this.subscribe(a,"notification",(t=>{this.log("debug","üì© Notificaci√≥n recibida:",t.data),e(t.data)})),t&&this.subscribe(a,"data.updated",(e=>{this.log("debug","üîÑ Datos actualizados:",e.data),t(e.data)})),n&&this.subscribe(a,"alert",(e=>{this.log("debug","‚ö†Ô∏è Alerta recibida:",e.data),n(e.data)})),a}subscribeToAgency(e){if(!this.config.agencyId)return this.log("warn","No se puede suscribir: agencyId no configurado"),null;const t=`${this.config.channelPrefix}:agency:${this.config.agencyId}`,n=this.getChannel(t);return this.subscribe(n,"notification",(t=>{this.log("debug","üì¢ Notificaci√≥n de agencia:",t.data),e(t.data)})),n}subscribeToBroadcast(e){const t=`${this.config.channelPrefix}:broadcast`,n=this.getChannel(t);return this.subscribe(n,"notification",(t=>{this.log("debug","üì° Broadcast recibido:",t.data),e(t.data)})),n}subscribeToChannel(e,t,n){const o=this.getChannel(e);return this.subscribe(o,t,n),o}getChannel(e){if(!this.channels.has(e)){const t=this.realtime.channels.get(e);this.channels.set(e,t),this.log("debug",`üìù Canal creado: ${e}`)}return this.channels.get(e)}subscribe(e,t,n){e.subscribe(t,n);const o=`${e.name}:${t}`;this.handlers.has(o)||this.handlers.set(o,[]),this.handlers.get(o).push(n)}unsubscribe(e,t=null){const n=this.channels.get(e);if(n)if(t){n.unsubscribe(t);const o=`${e}:${t}`;this.handlers.delete(o),this.log("debug",`üîá Desuscrito de ${e}:${t}`)}else{n.unsubscribe();for(const[t]of this.handlers)t.startsWith(e+":")&&this.handlers.delete(t);this.log("debug",`üîá Desuscrito de ${e}`)}}unsubscribeAll(){for(const[e,t]of this.channels)t.unsubscribe(),this.log("debug",`üîá Desuscrito de ${e}`);this.handlers.clear(),this.channels.clear()}publish(e,t,n){if(!this.isConnected())return this.log("warn","No se puede publicar: no conectado"),Promise.reject(new Error("Not connected"));return this.getChannel(e).publish(t,n)}async getHistory(e,t={}){const n=this.getChannel(e),o={limit:10,direction:"backwards",...t};try{return(await n.history(o)).items.map((e=>({id:e.id,name:e.name,data:e.data,timestamp:e.timestamp})))}catch(a){return this.log("error","Error obteniendo historial:",a),[]}}isConnected(){return"connected"===this.connectionState}getConnectionState(){return this.connectionState}close(){this.realtime&&(this.unsubscribeAll(),this.realtime.close(),this.connectionState="closed",this.log("info","üîå Conexi√≥n cerrada"))}emit(e,t=null){const n=new CustomEvent(`ably:${e}`,{detail:t});window.dispatchEvent(n)}on(e,t){window.addEventListener(`ably:${e}`,(e=>t(e.detail)))}log(e,...t){if("debug"===e&&!this.config.debug)return}}const d={showToast(e){const{type:t,message:n,useSwal:o=!1,duration:a=5e3}=e;if(o&&window.Swal){const e={success:"success",error:"error",warning:"warning",info:"info"};window.Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:a,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",window.Swal.stopTimer),e.addEventListener("mouseleave",window.Swal.resumeTimer)}}).fire({icon:e[t]||"info",title:n})}else if(window.toastr){const e=t||"info",o={closeButton:!0,progressBar:!0,timeOut:a,positionClass:"toast-top-right"};window.toastr[e](n,"",o)}else if(window.Swal){const e={success:"success",error:"error",warning:"warning",info:"info"};window.Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:a,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",window.Swal.stopTimer),e.addEventListener("mouseleave",window.Swal.resumeTimer)}}).fire({icon:e[t]||"info",title:n})}},playSound(e="/assets/sounds/notification.mp3"){try{const t=new Audio(e);t.volume=.5,t.play().catch((e=>{}))}catch(t){}},reloadDataTable(e){if(window.$&&$.fn.DataTable){const t=$(`#${e}`).DataTable();t&&t.ajax.reload(null,!1)}}};function u(){document.querySelectorAll(".decimal-cleave-zen").forEach((e=>{if(e.dataset.cleaveInitialized)return;const t=e.dataset.decimals||2,n=e.dataset.prefix||"";e.addEventListener("input",(e=>{e.target.value=c(e.target.value,{numeralThousandsGroupStyle:"thousand",numeralDecimalScale:parseInt(t),prefix:n})})),e.dataset.cleaveInitialized="true",e.value&&(e.value=c(e.value,{numeralThousandsGroupStyle:"thousand",numeralDecimalScale:parseInt(t),prefix:n}))}))}function f(e){const t=document.querySelector(".loader-container");switch(e){case 1:t.classList.remove("loading--hide"),t.classList.add("loading--show");break;case 0:t.classList.add("loading--hide"),t.classList.remove("loading--show")}}function h(e,t){return(e.replace(/\/+$/,"")+(t.startsWith("/")?t:"/"+t)).replace(/([^:])\/\/+/g,"$1/")}function m(e,t,o,a){f(1);let r="views/"+o+".php";n.ajax({url:r,method:"POST",data:{condi:e,xtra:a},success:function(e){f(0),n(t).html(e),u()},error:function(e){f(0);const t=JSON.parse(e.responseText);"messagecontrol"in t&&(Swal.fire({icon:"error",title:"¬°ERROR!",text:"Informaci√≥n de error: "+t.mensaje}).then((()=>{})),setTimeout((()=>{window.location.reload()}),2e3))}})}function g(e,t){f(1);let o=document.getElementById("condi").value,a=document.getElementById("file").value+".php";n.ajax({url:a,method:"POST",data:{condi:o,xtra:t},success:function(t){f(0),n(e).html(t),u()},error:function(e){f(0);const t=JSON.parse(e.responseText);"messagecontrol"in t&&(Swal.fire({icon:"error",title:"¬°ERROR!",text:"Informaci√≥n de error: "+t.mensaje}).then((()=>{})),setTimeout((()=>{window.location.reload()}),2e3))}})}function p(e,t={}){const{route:o=null,method:a="GET",legacyDir:r=null,condi:i="",data:s={},useLegacy:c=!1,csrfToken:l=null,onSuccess:d=null,onError:g=null}=t;if(c||!o){if(!r)return;return void m(i,e,r,s)}f(1);const p={condi:i,...s},w={};if(l)w["X-CSRF-TOKEN"]=l;else{const e=document.querySelector('input[name="csrf_token"]');e&&e.value&&(w["X-CSRF-TOKEN"]=e.value)}n.ajax({url:h(BASE_URL_FOR_JS,o),method:a,data:p,headers:w,success:function(t){f(0);try{const o="string"==typeof t?JSON.parse(t):t;if(1!==o.status)throw new Error(o.message||"Error al cargar la vista");{const t=o.html||o.data||"";n(e).html(t),u(),d&&"function"==typeof d&&d(o)}}catch(o){n(e).html(t),u(),d&&"function"==typeof d&&d({html:t})}},error:function(t){f(0);let n="Error al cargar la vista";try{const e=JSON.parse(t.responseText);n=e.message||e.error||n,e.messagecontrol&&Swal.fire({icon:"error",title:"Error",html:e.messagecontrol,confirmButtonText:"Aceptar"})}catch(o){}r?m(i,e,r,s):Swal.fire({icon:"error",title:"Error",text:n,confirmButtonText:"Aceptar"}),g&&"function"==typeof g&&g(t)}})}function w(e){const t={};for(let o=0;o<e.length;o++){const a=e[o],r=document.getElementById(a);if(r)if(r.classList.contains("decimal-cleave-zen"))try{t[a]=String(i(r.value))}catch(n){t[a]=r.value}else t[a]=r.value;else t[a]=""}return t}function b(e){const t={};for(var n=0;n<e.length;){var o=document.getElementById(e[n]);t[e[n]]=o.options[o.selectedIndex].value,n++}return t}function y(e){const t={};for(var n=0;n<e.length;)t[e[n]]=document.querySelector('input[name="'+e[n]+'"]:checked').value,n++;return t}function S(e){const t=document.querySelector(e);if(!t)return{};const n={};return t.querySelectorAll("input, select, textarea").forEach((e=>{const t=e.name||e.id;if(t)if("checkbox"===e.type)n[t]=e.checked;else if("radio"===e.type)e.checked&&(n[t]=e.value);else if(e.classList.contains("decimal-cleave-zen"))try{n[t]=String(i(e.value))}catch(o){n[t]=e.value}else n[t]=e.value})),n}function x(e,t,o,a,r,i,s,c){n.ajax({url:BASE_URL_FOR_JS+"src/cruds/"+c+".php",method:"POST",data:{inputs:e,selects:t,radios:o,condi:a,id:r,archivo:i},beforeSend:function(){f(1)},success:function(e){const t=JSON.parse(e);if(1==t.status)Swal.fire({icon:"success",title:"Muy Bien!",text:t.message}),g("#cuadro",r),"function"==typeof s&&s(t);else{var n="reprint"in t?t.reprint:0,o="timer"in t?t.timer:6e4;Swal.fire({icon:"warning",title:"¬°Advertencia!",text:t.message,timer:o}),1==n&&setTimeout((function(){g("#cuadro",r)}),1500)}},complete:function(){f(0)}})}function v(e,t,n){let o=[];function a(e,t){const n=e.id||e.name||"input-"+Math.random().toString(36).slice(2),o=`feedback-${n}`;var a;document.querySelectorAll(`[data-feedback-for="${n}"], #${a=o,window.CSS&&CSS.escape?CSS.escape(a):String(a).replace(/(["\\\[\]])/g,"\\$1")}`).forEach((e=>e.remove()));const r=document.createElement("div");r.className="error-message text-sm text-error mt-2 flex items-start gap-2",r.id=o,r.setAttribute("role","alert"),r.setAttribute("data-feedback-for",n),r.innerHTML=`<i class="fas fa-exclamation-circle mr-1 mt-0.5"></i><div>${t}</div>`;try{e.setAttribute("aria-invalid","true"),e.setAttribute("aria-describedby",o)}catch(s){}e.classList.remove("input-success","select-success","textarea-success"),e.classList.add("input-error","select-error","textarea-error"),e.classList.remove("is-invalid","is-valid");const i=e.closest(".form-control")||e.closest(".input-group")||e.parentNode||document.body;return i&&i.contains(e)&&e.nextSibling?e.parentNode.insertBefore(r,e.nextSibling):i.appendChild(r),t}function r(e){const t=e.id||e.name;try{e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby")}catch(o){}if(e.classList.remove("input-error","select-error","textarea-error"),e.classList.remove("is-invalid"),"SELECT"===e.tagName?e.classList.add("select-success"):"TEXTAREA"===e.tagName?e.classList.add("textarea-success"):e.classList.add("input-success"),t){document.querySelectorAll(`[data-feedback-for="${t}"]`).forEach((e=>e.remove()));const e=document.getElementById(`feedback-${t}`);e&&e.remove()}const n=e.nextElementSibling;n&&(n.classList.contains("error-message")||n.classList.contains("invalid-feedback"))&&n.remove()}return e.forEach((e=>{const t=document.getElementById(e);if(t){let n=!1;const s=t.getAttribute("data-label")||e,c=t.value||"",l=t.classList.contains("decimal-cleave-zen"),d=l?String(i(c)).trim():String(c).trim();if(t.hasAttribute("required")&&(d||(o.push(a(t,`El campo ${s} es obligatorio`)),n=!0)),"email"===t.type&&d){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d)||(o.push(a(t,"Ingrese un email v√°lido")),n=!0)}if(("number"===t.type||l)&&d){const e=t.getAttribute("min"),r=t.getAttribute("max"),i=parseFloat(d);isNaN(i)?(o.push(a(t,"Ingrese un valor num√©rico v√°lido")),n=!0):(e&&i<parseFloat(e)&&(o.push(a(t,`El valor m√≠nimo es ${e}`)),n=!0),r&&i>parseFloat(r)&&(o.push(a(t,`El valor m√°ximo es ${r}`)),n=!0))}if(!l){const e=t.getAttribute("minlength"),r=t.getAttribute("maxlength"),i=d.length;e&&i<parseInt(e,10)&&(o.push(a(t,`M√≠nimo ${e} caracteres`)),n=!0),r&&i>parseInt(r,10)&&(o.push(a(t,`M√°ximo ${r} caracteres`)),n=!0)}n||r(t)}})),t.forEach((e=>{const t=document.getElementById(e);t&&t.hasAttribute("required")&&("0"===t.value||""===t.value?o.push(a(t,"Seleccione una opci√≥n")):r(t))})),n.forEach((e=>{const t=document.getElementsByName(e);if(t.length>0&&t[0].hasAttribute("required")){let e=!1;t.forEach((t=>{t.checked&&(e=!0)})),e?t.forEach((e=>r(e))):o.push(a(t[t.length-1],"Seleccione una opci√≥n"))}})),{esValido:0===o.length,errores:o}}function E(){if(!window.ablyConfig||!window.ablyConfig.enabled||!window.ablyConfig.clientKey)return null;try{const e=new l({clientKey:window.ablyConfig.clientKey,channelPrefix:window.ablyConfig.channelPrefix||"app",channelHuella:window.ablyConfig.channelHuella||"huella",userId:window.currentUserId||null,agencyId:window.currentAgencyId||null,enabled:!1!==window.ablyConfig.enabled,debug:"development"===window.ENVIRONMENT});return window.currentUserId&&e.subscribeToUser((e=>{d.showToast(e),!1!==e.playSound&&window.ablyConfig.enableSound&&d.playSound()}),(e=>{const t={cliente:"clientesTable",prestamo:"prestamosTable",pago:"pagosTable",caja:"cajaTable",ahorro:"ahorrosTable"}[e.entity];t&&d.reloadDataTable(t),d.showToast({type:"info",message:`${e.entity} actualizado`})}),(e=>{if("undefined"!=typeof Swal){const t={info:"info",warning:"warning",critical:"error"};Swal.fire({icon:t[e.severity]||"info",title:"critical"===e.severity?"‚ö†Ô∏è ALERTA CR√çTICA":"Alerta",text:e.message,confirmButtonText:"Entendido",allowOutsideClick:"critical"!==e.severity})}})),window.currentAgencyId&&e.subscribeToAgency((e=>{d.showToast({type:e.type||"info",message:`üì¢ ${e.message}`})})),e.subscribeToBroadcast((e=>{"undefined"!=typeof Swal&&Swal.fire({icon:"warning"===e.type?"warning":"info",title:"Anuncio del Sistema",html:e.message,showConfirmButton:!0,confirmButtonText:"Entendido",allowOutsideClick:!1,position:"top"})})),e.on("connected",(()=>{T("connected")})),e.on("disconnected",(()=>{T("disconnected")})),e.on("failed",(()=>{T("failed")})),window.ablyHelper=e,window.notificationHelper=d,e}catch(e){return null}}function T(e){const t=document.getElementById("ably-status");if(!t)return;const n={connected:{text:"Conectado",class:"bg-green-500 text-white"},connecting:{text:"Conectando...",class:"bg-yellow-500 text-white"},disconnected:{text:"Desconectado",class:"bg-red-500 text-white"},failed:{text:"Error",class:"bg-red-700 text-white"}},o=n[e]||n.disconnected;t.textContent=o.text,t.className=`px-3 py-1 rounded-full text-xs ${o.class}`}r(n),e.plugin(t),window.Alpine=e,e.start(),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("search-input");function t(){e.focus()}document.getElementById("search-button").addEventListener("click",t),document.addEventListener("keydown",(function(e){(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),t())})),document.addEventListener("keydown",(function(n){"/"===n.key&&document.activeElement!==e&&(n.preventDefault(),t())})),f(0),function(){let e=!1;window.addEventListener("resize",(function(){window.outerWidth-window.innerWidth>160||window.outerHeight-window.innerHeight>160?e||(e=!0):e=!1}))}()})),"undefined"!=typeof window&&(window.startValidationGeneric=function(e){const t=document.querySelector(e);t&&(t.addEventListener("keyup",(e=>{e.target.matches('input:not([type="radio"]), textarea')&&v([e.target.id],[],[])}),!0),t.addEventListener("change",(e=>{e.target.matches('input:not([type="radio"]), textarea')&&v([e.target.id],[],[]),e.target.matches("select")&&v([],[e.target.id],[]),e.target.matches('input[type="radio"]')&&v([],[],[e.target.name])})))},window.validarCamposGeneric=v,window.reportes=function(e,t,o,a=1,r=0,i="kpi",s=!1){const c=()=>{var r=[];r[0]=w(e[0]),r[1]=b(e[1]),r[2]=y(e[2]),r[3]=e[3];var s=`./${i}/reportes/${o}.php`;n.ajax({url:s,async:!0,type:"POST",dataType:"html",contentType:"application/x-www-form-urlencoded",data:{datosval:r,tipo:t},beforeSend:function(){f(1)},success:function(e){var o=JSON.parse(e);if(1==o.status){switch(a){case 0:window.open().document.write("<object data='"+o.data+"' type='application/"+o.tipo+"' width='100%' height='100%'></object>");break;case 1:var r=n("<a href='"+o.data+"' download='"+o.namefile+"."+t+"'>");n("body").append(r),r[0].click(),r.remove()}Swal.fire({icon:"success",title:"Muy Bien!",text:o.mensaje})}else Swal.fire({icon:"error",title:"¬°ERROR!",text:o.mensaje})},complete:function(){f(0)}})};!1!==s?Swal.fire({title:"Confirmaci√≥n",text:s,icon:"warning",showCancelButton:!0,confirmButtonText:"S√≠, continuar",cancelButtonText:"Cancelar"}).then((e=>{e.isConfirmed&&c()})):c()},window.obtiene=function(e,t,n,o,a,r,i="NULL",s=!1,c="crud_kpi"){if(!v(e,t,n).esValido)return!1;var l,d,u;l=w(e),d=b(t),u=y(n),!1!==s?Swal.fire({title:"Confirmaci√≥n",text:s,icon:"warning",showCancelButton:!0,confirmButtonText:"S√≠, continuar",cancelButtonText:"Cancelar"}).then((e=>{e.isConfirmed&&x(l,d,u,o,a,r,i,c)})):x(l,d,u,o,a,r,i,c)},window.submitForm=function(e,t={}){const o=document.querySelector(e);if(!o)return;const{action:a=o.getAttribute("data-action")||o.getAttribute("action"),method:r=o.getAttribute("data-method")||o.getAttribute("method")||"POST",extraData:i={},onSuccess:s=null,onError:c=null,confirmMessage:l=!1,successMessage:d=null,reloadAfter:u=!1,afterSuccess:m=null}=t;if(!a)return;const g=r.toUpperCase();if(!["GET","POST","PUT","PATCH","DELETE"].includes(g))return;const w=[],b=[],y=new Set;if(o.querySelectorAll("input[required], select[required], textarea[required]").forEach((e=>{"radio"===e.type?y.add(e.name):"SELECT"===e.tagName?e.id&&b.push(e.id):e.id&&w.push(e.id)})),"DELETE"!==g&&"GET"!==g&&!v(w,b,Array.from(y)).esValido)return!1;const x=()=>{const t=null!==o.querySelector('input[type="file"]');let r;if(t)r=new FormData,o.querySelectorAll("input, select, textarea").forEach((e=>{const t=e.name||e.id;t&&("file"===e.type?e.files&&e.files.length>0&&(e.multiple?Array.from(e.files).forEach((e=>{r.append(`${t}[]`,e)})):r.append(t,e.files[0])):"checkbox"===e.type?r.append(t,e.checked?"1":"0"):"radio"===e.type?e.checked&&r.append(t,e.value):r.append(t,e.value))})),Object.keys(i).forEach((e=>{r.append(e,i[e])}));else{const t=S(e);r={...t,...i}}f(1);const l=o.querySelector('input[name="csrf_token"]'),w={};l&&l.value&&(t||(w["X-CSRF-TOKEN"]=l.value),t&&r.append("csrf_token",l.value));const b={url:h(BASE_URL_FOR_JS,a),method:g,headers:w,success:function(e){f(0);try{const t="string"==typeof e?JSON.parse(e):e;if(1===t.status||"1"===t.status){if(Swal.fire({icon:"success",title:"¬°√âxito!",text:d||t.message||"Operaci√≥n completada exitosamente"}),t.reload&&t.reload.route){const e=t.reload.target||"#cuadro",n={route:t.reload.route,method:t.reload.method||"GET",condi:t.reload.condi||"",data:t.reload.data||{},csrfToken:t.reload.csrfToken||l?.value||null};setTimeout((()=>{p(e,n)}),800)}s&&"function"==typeof s&&s(t),u&&m&&"function"==typeof m&&setTimeout((()=>{m(t)}),1e3)}else{const e=t.timer||6e3;Swal.fire({icon:"warning",title:"¬°Advertencia!",text:t.message||"Error en la operaci√≥n",timer:e}),c&&"function"==typeof c&&c(t)}}catch(t){Swal.fire({icon:"error",title:"Error",text:"Error al procesar la respuesta del servidor"})}},error:function(e){f(0);try{const t=JSON.parse(e.responseText);t.messagecontrol?Swal.fire({icon:"error",title:"Error",html:t.messagecontrol}):Swal.fire({icon:"error",title:"Error",text:t.message||t.error||"Error en la operaci√≥n"})}catch(t){Swal.fire({icon:"error",title:"Error",text:"Error al comunicarse con el servidor"})}c&&"function"==typeof c&&c(e)}};if("GET"===g){const e=new URLSearchParams(t?{}:r).toString();b.url+=e?"?"+e:""}else b.data=r,t?(b.processData=!1,b.contentType=!1):b.contentType="application/x-www-form-urlencoded; charset=UTF-8";n.ajax(b)};!1!==l?Swal.fire({title:"Confirmaci√≥n",text:l,icon:"warning",showCancelButton:!0,confirmButtonText:"S√≠, continuar",cancelButtonText:"Cancelar"}).then((e=>{e.isConfirmed&&x()})):x()},window.sendRequest=function(e={}){const{url:t,method:o="POST",data:a={},onSuccess:r=null,onError:i=null,confirmMessage:s=!1,successMessage:c=null,loader:l=!0,showMessage:d=1}=e;if(!t)return;const u=o.toUpperCase();if(!["GET","POST","PUT","PATCH","DELETE"].includes(u))return;const m=()=>{l&&f(1);const e=document.querySelector('input[name="csrf_token"]'),o={};e&&e.value&&(o["X-CSRF-TOKEN"]=e.value);const s={url:h(BASE_URL_FOR_JS,t),method:u,headers:o,success:function(t){l&&f(0);try{const n="string"==typeof t?JSON.parse(t):t;if(1===n.status||"1"===n.status){if(0!==d&&Swal.fire({icon:"success",title:"¬°√âxito!",text:c||n.message||"Operaci√≥n completada exitosamente"}),n.reload&&n.reload.route){const t=n.reload.target||"#cuadro",o={route:n.reload.route,method:n.reload.method||"GET",condi:n.reload.condi||"",data:n.reload.data||{},csrfToken:n.reload.csrfToken||e?.value||null};setTimeout((()=>{p(t,o)}),800)}r&&"function"==typeof r&&r(n)}else 0!==d&&Swal.fire({icon:"warning",title:"¬°Advertencia!",text:n.message||"Error en la operaci√≥n",timer:n.timer||6e3}),i&&"function"==typeof i&&i(n)}catch(n){0!==d&&Swal.fire({icon:"error",title:"Error",text:"Error al procesar la respuesta del servidor"})}},error:function(e){if(l&&f(0),0!==d)try{const t=JSON.parse(e.responseText);Swal.fire({icon:"error",title:"Error",text:t.message||t.error||"Error en la operaci√≥n"})}catch(t){Swal.fire({icon:"error",title:"Error",text:"Error al comunicarse con el servidor"})}i&&"function"==typeof i&&i(e)}};if("GET"===u){const e=new URLSearchParams(a).toString();s.url+=e?"?"+e:""}else s.data=a,s.contentType="application/x-www-form-urlencoded; charset=UTF-8";n.ajax(s)};!1!==s?Swal.fire({title:"Confirmaci√≥n",text:s,icon:"warning",showCancelButton:!0,confirmButtonText:"S√≠, continuar",cancelButtonText:"Cancelar"}).then((e=>{e.isConfirmed&&m()})):m()},window.getFormDataFromContainer=S,window.printdiv=m,window.printdiv2=g,window.loadModuleView=p,window.loadView=function(e,t,n,o,a={}){const r=window.MIGRATED_MODULES||{};r[n]&&r[n][o]?p(e,{route:r[n][o].route,legacyDir:r[n][o].legacy,condi:t,data:a}):m(t,e,`${n}/${o}`,a)},window.getinputsval=w,window.getselectsval=b,window.getradiosval=y,window.loaderefect=f,window.initServerSideDataTable=function(e,t,a,r={}){const i={processing:!0,serverSide:!0,ajax:{url:"../../app/server_side/"+t+".php",type:r.ajaxMethod||"GET",data:function(e){r.whereExtra&&(e.whereExtra="function"==typeof r.whereExtra?r.whereExtra():r.whereExtra),r.customData&&Object.assign(e,"function"==typeof r.customData?r.customData(e):r.customData)},error:function(e,t,n){r.onError&&"function"==typeof r.onError&&r.onError(e,t,n)}},columns:a,pageLength:r.pageLength||10,lengthMenu:r.lengthMenu||[[5,10,25,50,100],[5,10,25,50,100]],ordering:void 0===r.ordering||r.ordering,searching:void 0===r.searching||r.searching,language:o,dom:r.dom||'<"flex flex-col sm:flex-row justify-between items-center mb-4 gap-2"lf>rt<"flex flex-col sm:flex-row justify-between items-center mt-4 gap-2"ip>',order:r.order||[[0,"desc"]],headerCallback:function(e,t,o,a,i){const s="bg-base-300 text-base-content font-bold text-sm py-3 px-4 border-b-2 border-primary";n(e).find("th").each((function(e){n(this).addClass(s),r.headerClasses&&Array.isArray(r.headerClasses)&&r.headerClasses[e]&&(n(this).removeClass(s),n(this).addClass(r.headerClasses[e]))})),r.onHeaderCallback&&"function"==typeof r.onHeaderCallback&&r.onHeaderCallback(e,t,o,a,i)},rowCallback:function(e,t,o){r.rowClasses&&Array.isArray(r.rowClasses)&&n(e).find("td").each((function(e){r.rowClasses[e]&&n(this).addClass(r.rowClasses[e])})),r.onRowCallback&&"function"==typeof r.onRowCallback&&r.onRowCallback(e,t,o)},drawCallback:function(e){r.onDrawCallback&&"function"==typeof r.onDrawCallback&&r.onDrawCallback(e)},...r};return n(e).DataTable(i)},window.convert_table_to_datatable=function(e,t={}){try{const o={lengthMenu:[[5,10,15,-1],["5 filas","10 filas","15 filas","Mostrar todos"]],mostrarBuscador:!0,mostrarInfo:!0,mostrarPaginacion:!0,pageLength:10,language:{lengthMenu:"Mostrar _MENU_ registros",zeroRecords:"No se encontraron registros",info:" ",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de: _MAX_ registros)",sSearch:"Buscar: ",oPaginate:{sFirst:"Primero",sLast:"√öltimo",sNext:"Siguiente",sPrevious:"Anterior"},sProcessing:"Procesando..."},datatableOptions:{}},a={...o,...t,language:{...o.language,...t.language||{}}},r={lengthMenu:a.lengthMenu,pageLength:a.pageLength,language:a.language,searching:a.mostrarBuscador,info:a.mostrarInfo,paging:a.mostrarPaginacion,...a.datatableOptions};return n("#"+e).DataTable(r)}catch(o){return Swal.fire({icon:"error",title:"Error",text:"Ocurri√≥ un error al cargar la tabla. Intente de nuevo."}),null}},window.initTomSelect=function(e,t={}){const n={create:!1,sortField:{field:"text",direction:"asc"},placeholder:"Seleccione una opci√≥n",maxOptions:200,allowEmptyOption:!0,plugins:{clear_button:{title:"Limpiar selecci√≥n"}},render:{no_results:function(e,t){return'<div class="no-results">No se encontraron resultados</div>'},option_create:function(e,t){return'<div class="create">Agregar <strong>'+t(e.input)+"</strong>&hellip;</div>"}},onInitialize:function(){},...t},o=document.querySelector(e);return o?new s(o,n):null},window.initSelect2=function(e,t={}){const o={width:"100%",placeholder:"Seleccione una opci√≥n",allowClear:!0,language:{noResults:function(){return"No se encontraron resultados"},searching:function(){return"Buscando..."},loadingMore:function(){return"Cargando m√°s resultados..."}},theme:"default",...t},a=n(e);return 0===a.length?null:(a.data("select2")&&a.select2("destroy"),a.select2(o),a)},window.getAlpineData=function(e,t){const n=document.querySelector(e);if(!n||!n._x_dataStack)return null;const o=n._x_dataStack[0];return t?o[t]:o},window.$=n,window.MIGRATED_MODULES=window.MIGRATED_MODULES||{}),document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>{E()}),500)})),window.addEventListener("beforeunload",(()=>{window.ablyHelper&&window.ablyHelper.close()})),window.initAblyNotifications=E;
